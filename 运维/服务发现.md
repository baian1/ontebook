# 服务发现

服务发现有三个角色,服务提供者、服务消费者和服务中介.

- 服务提供者,简单点说就是一个HTTP服务器,提供了API服务,有一个IP端口作为服务地址.服务消费者是什么,它就是一个简单的进程,想要访问服务提供者提供的服务来干一些事情.
- 服务中介是联系服务提供者和服务消费者的桥梁,服务提供者将自己提供的服务地址注册到服务中介,服务中介提供多个服务,每个服务对应多个服务提供者.
- 服务消费者从服务中介那里查找自己想要的服务的地址,然后享受这个服务.

服务中介就是一个字典,字典里有很多key/value键值对,key是服务名称,value是服务提供者的地址列表.服务注册就是调用字典的Put方法塞东西,服务查找就是调用字典的Get方法拿东西.

当服务提供者节点挂掉时,要求服务能够及时取消注册,比便及时通知消费者重新获取服务地址.

当服务提供者新加入时,要求服务中介能及时告知服务消费者,你要不要尝试一下新的服务.

---

关键点:

1. 当服务挂掉时,能通过一定方式告知中介清除这个地址
2. 服务列表变动,如何通知消费者,轮询/pubsub

参考:[服务发现的基本原理](https://zhuanlan.zhihu.com/p/34332329)

## 常用系统

- zookeeper
- etcd
- consul
